<!DOCTYPE html>
<html lang="gu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Milk Management System</title>
<link rel="icon" type="image/x-icon" href="Milk.ico">

<style>
:root{--p:#020617;--b:#2563eb;--g:#16a34a;--r:#dc2626;}

*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,system-ui;background:linear-gradient(120deg,#e0f2fe,#f8fafc);}

header{
background:linear-gradient(135deg,#020617,#0f172a);
color:white;padding:1.5rem;text-align:center;font-size:1.3rem;
}
.header-logo
  {width:AUTO;
   border-radius:0%;
   background:TRANSPARENT;
   padding:0px;
   margin-bottom:1px}

.container{max-width:1100px;margin:auto;padding:15px;padding-bottom:80px}

.page{display:none;animation:slideFade .35s cubic-bezier(.4,0,.2,1)}
.active{display:block}

@keyframes slideFade{
from{opacity:0;transform:translateY(25px) scale(.97)}
to{opacity:1;transform:none}
}

.home-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-top:18px}
@media(max-width:700px){.home-grid{grid-template-columns:repeat(2,1fr)}}

.home-btn{
background:linear-gradient(135deg,#fff,#f1f5f9);
border-radius:22px;padding:22px 10px;text-align:center;
font-weight:800;box-shadow:0 10px 25px #0002;
cursor:pointer;transition:.25s cubic-bezier(.4,0,.2,1);
}
.home-btn:hover{
transform:translateY(-6px) scale(1.02);
box-shadow:0 18px 35px #0003;
background:linear-gradient(135deg,#e0f2fe,#fff);
}
.home-btn:active{transform:scale(.95)}

.cardBox{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:15px}
.card{
background:white;border-radius:20px;padding:20px;text-align:center;
font-weight:700;box-shadow:0 10px 25px #0002;
}

form,.box{background:white;border-radius:22px;padding:18px;box-shadow:0 10px 30px #0002}

input,select{
width:100%;padding:12px;border-radius:12px;
border:1px solid #cbd5e1;margin:6px 0 12px
}

.btn-group{display:flex;gap:10px;margin-top:10px}

.btn{
width:100%;padding:12px;border:none;border-radius:14px;
font-weight:700;cursor:pointer;color:white;
transition:.2s;
}
.btn:active{transform:scale(.95)}

.green{background:linear-gradient(135deg,#16a34a,#22c55e)}
.red{background:linear-gradient(135deg,#dc2626,#ef4444)}
.blue{background:linear-gradient(135deg,#2563eb,#38bdf8)}
.gray{background:#64748b}

table{
width:100%;border-collapse:collapse;margin-top:10px;
background:white;border-radius:16px;overflow:hidden
}
th{background:#020617;color:white;padding:10px}
td{padding:8px;border-bottom:1px solid #e5e7eb;text-align:center}

tr{animation:rowIn .35s ease}
@keyframes rowIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1}}

.back-btn{
margin-bottom:10px;background:#020617;color:white;
padding:8px 14px;border-radius:12px;cursor:pointer;
transition:.2s
}
.back-btn:active{transform:scale(.95)}

.success{animation:pulse .4s}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}

.shake{animation:shake .3s}
@keyframes shake{
0%{transform:translateX(0)}
25%{transform:translateX(-5px)}
50%{transform:translateX(5px)}
75%{transform:translateX(-5px)}
100%{transform:translateX(0)}
}
</style>
</head>

<body>

<header>
  <img src="Milk.ico" alt="Logo" class="header-logo"><br>ü•õ Milk Management System
</header>

<div class="container">

<div id="home" class="page active">
<div class="cardBox">
<div class="card">üêÑ Cow Milk<br><span id="dc">0</span> Lt</div>
<div class="card">üêÉ Buffalo Milk<br><span id="db">0</span> Lt</div>
</div>

<div class="home-grid">
<div class="home-btn" onclick="show('stock')">ü•õ STOCK</div>
<div class="home-btn" onclick="show('sales')">‚ûï SALES</div>
<div class="home-btn" onclick="show('allreport')">üìÑ ALL REPORT</div>
<div class="home-btn" onclick="show('custreport')">üë• CUSTOMER REPORT</div>
<div class="home-btn" onclick="show('addcust')">üë§ ADD CUSTOMER</div>
<div class="home-btn" onclick="show('recycle')">‚ôªÔ∏è RECYCLE BIN</div>
</div>
</div>

<!-- SALES -->
<div id="sales" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>‚ûï SALES</h2>
<form id="salesBox">
<label>Date</label><input type="date" id="sDate">
<label>Customer</label><select id="sCust"></select>
<label>Milk Type</label><select id="sType"><option>Cow</option><option>Buffalo</option></select>
<label>Quantity (Lt)</label><input type="number" step="0.1" id="sQty">
<div class="btn-group">
<button type="button" onclick="handleSales('Morning')" class="btn green">üåÖ Morning</button>
<button type="button" onclick="handleSales('Evening')" class="btn blue">üåô Evening</button>
</div>
<button type="button" onclick="clearSalesForm()" class="btn gray" style="margin-top:10px">Clear</button>
</form>
</div>

<!-- ALL REPORT -->
<div id="allreport" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>üìÑ ALL REPORT</h2>
<table id="allTable">
<thead><tr><th>Date</th><th>Name</th><th>Type</th><th>Qty</th><th>Amount</th><th>Action</th></tr></thead>
<tbody></tbody>
</table>
</div>

<!-- CUSTOMER REPORT -->
<div id="custreport" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>üë• CUSTOMER REPORT</h2>
<select id="repCust" onchange="custReport()"></select>
<button onclick="saveCustPDF()" class="btn blue" style="margin:10px 0;">Save Selected Customer PDF</button>
<div id="sum" style="margin:10px;font-weight:bold"></div>
<table>
<thead><tr><th>Date</th><th>Qty</th><th>Amount</th></tr></thead>
<tbody id="custTable"></tbody>
</table>
</div>

<!-- RECYCLE -->
<div id="recycle" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>‚ôªÔ∏è RECYCLE BIN</h2>
<table>
<thead><tr><th>Name</th><th>Qty</th><th>Type</th><th>Action</th></tr></thead>
<tbody id="recTable"></tbody>
</table>
</div>

<!-- STOCK -->
<div id="stock" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>ü•õ STOCK</h2>
<div class="box">
<select id="stType"><option>Cow</option><option>Buffalo</option></select>
<input type="number" id="stQty" placeholder="Liters">
<button onclick="addStock()" class="btn green">Update</button>
</div>
</div>

<!-- ADD CUSTOMERS -->
<div id="addcust" class="page">
<button class="back-btn" onclick="show('home')">‚¨Ö Back</button>
<h2>üë§ ADD CUSTOMERS</h2>

<div class="box">
<input id="cName" placeholder="Name">
<input id="cRate" placeholder="Rate">
<button onclick="addCustomer()" class="btn green">Save</button>
</div>

<h3>Customer List</h3>
<table>
<thead><tr><th>Name</th><th>Rate</th><th>Action</th></tr></thead>
<tbody id="custList"></tbody>
</table>
</div>

</div>

<script>
let customers=JSON.parse(localStorage.getItem("cust"))||[];
let sales=JSON.parse(localStorage.getItem("sales"))||[];
let stock=JSON.parse(localStorage.getItem("stock"))||{Cow:0,Buffalo:0};
let recycle=JSON.parse(localStorage.getItem("recycle"))||[];

sDate.valueAsDate=new Date(); refresh();

function show(id){
document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
document.getElementById(id).classList.add("active");
refresh();
}

function animateValue(el,start,end,duration=400){
let range=end-start,startTime=performance.now();
function step(now){
let p=Math.min((now-startTime)/duration,1);
el.innerText=(start+range*p).toFixed(1);
if(p<1)requestAnimationFrame(step);
}
requestAnimationFrame(step);
}

function save(){
localStorage.setItem("cust",JSON.stringify(customers));
localStorage.setItem("sales",JSON.stringify(sales));
localStorage.setItem("stock",JSON.stringify(stock));
localStorage.setItem("recycle",JSON.stringify(recycle));
}

function refresh(){
animateValue(dc,Number(dc.innerText)||0,stock.Cow);
animateValue(db,Number(db.innerText)||0,stock.Buffalo);

sCust.innerHTML=repCust.innerHTML='<option value="">Select Customer</option>';
customers.forEach(c=>{
sCust.innerHTML+=`<option>${c.name}</option>`;
repCust.innerHTML+=`<option>${c.name}</option>`;
});
loadAll(); loadRecycle(); loadCustomers();
}

function clearSalesForm(){
sQty.value=""; sCust.value=""; sType.value="Cow"; sDate.valueAsDate=new Date();
}

function handleSales(shift){
let q=+sQty.value,t=sType.value,cName=sCust.value;
if(!cName||q<=0)return alert("Details missing");
if(stock[t]<q){salesBox.classList.add("shake");setTimeout(()=>salesBox.classList.remove("shake"),300);return;}
let c=customers.find(x=>x.name==cName);
let time=new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
let d=sDate.value.split('-').reverse().join('-')+" "+time+" ("+shift+")";
sales.push({id:Date.now(),date:d,name:c.name,type:t,qty:q,amount:q*c.rate});
stock[t]-=q; save(); refresh();
salesBox.classList.add("success"); setTimeout(()=>salesBox.classList.remove("success"),400);
}

function loadAll(){
let tb=document.querySelector("#allTable tbody"); tb.innerHTML="";
sales.forEach(s=>{
tb.innerHTML+=`<tr>
<td>${s.date}</td><td>${s.name}</td><td>${s.type}</td>
<td>${s.qty}</td><td>‚Çπ${s.amount}</td>
<td>
<button onclick="editSale(${s.id})" class="btn blue" style="padding:5px">Edit</button>
<button onclick="del(${s.id})" class="btn red" style="padding:5px">Delete</button>
</td></tr>`;
});
}

function editSale(id){
let i=sales.findIndex(x=>x.id==id),s=sales[i];
let newQty=prompt("New Quantity",s.qty);
if(newQty&&newQty>0){
stock[s.type]+=s.qty;
if(stock[s.type]<newQty)return alert("Not enough stock");
stock[s.type]-=newQty;
s.qty=+newQty;
let c=customers.find(x=>x.name==s.name);
s.amount=s.qty*c.rate; save(); refresh();
}
}

function del(id){
let i=sales.findIndex(x=>x.id==id);
stock[sales[i].type]+=sales[i].qty;
recycle.push(sales[i]); sales.splice(i,1);
save(); refresh();
}

function loadRecycle(){
recTable.innerHTML="";
recycle.forEach((r,i)=>{
recTable.innerHTML+=`<tr>
<td>${r.name}</td><td>${r.qty}</td><td>${r.type}</td>
<td>
<button onclick="restore(${i})" class="btn green" style="padding:5px">Restore</button>
<button onclick="permDel(${i})" class="btn red" style="padding:5px">X</button>
</td></tr>`;
});
}

function restore(i){
let r=recycle[i];
if(stock[r.type]<r.qty)return alert("Not enough stock");
stock[r.type]-=r.qty; sales.push(r); recycle.splice(i,1);
save(); refresh();
}
function permDel(i){if(confirm("Delete permanently?")){recycle.splice(i,1);save();refresh();}}

function addStock(){stock[stType.value]+=+stQty.value;save();refresh();stQty.value="";}
function addCustomer(){customers.push({name:cName.value,rate:+cRate.value});save();refresh();cName.value=cRate.value="";}

function loadCustomers(){
custList.innerHTML="";
customers.forEach((c,i)=>{
custList.innerHTML+=`<tr>
<td>${c.name}</td><td>‚Çπ${c.rate}</td>
<td>
<button onclick="editCust(${i})" class="btn blue" style="padding:5px">Edit</button>
<button onclick="delCust(${i})" class="btn red" style="padding:5px">Delete</button>
</td></tr>`;
});
}

function editCust(i){
let n=prompt("Name",customers[i].name);
let r=prompt("Rate",customers[i].rate);
if(n&&r){customers[i].name=n;customers[i].rate=+r;save();refresh();}
}
function delCust(i){if(confirm("Delete customer?")){customers.splice(i,1);save();refresh();}}

function custReport(){
let name=repCust.value; custTable.innerHTML=""; let tq=0,ta=0;
sales.filter(s=>s.name==name).forEach(s=>{
tq+=s.qty; ta+=s.amount;
custTable.innerHTML+=`<tr><td>${s.date}</td><td>${s.qty}</td><td>‚Çπ${s.amount}</td></tr>`;
});
sum.innerHTML=name?`Total: ${tq.toFixed(2)} Lt | ‚Çπ${ta.toFixed(2)}`:"";
}

function saveCustPDF(){
if(!repCust.value) return alert("Select customer first");
let original=document.body.innerHTML;
let report=document.getElementById("custreport").innerHTML;
document.body.innerHTML="<h2>Customer Report</h2>"+report;
window.print();
document.body.innerHTML=original;
location.reload();
}
</script>
</body>
</html>
